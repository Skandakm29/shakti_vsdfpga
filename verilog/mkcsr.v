//
// Generated by Bluespec Compiler, version 2021.07 (build 4cac6eba)
//
// On Fri Mar  7 14:49:27 IST 2025
//
//
// Ports:
// Name                         I/O  size props
// system_instruction             O   129
// RDY_system_instruction         O     1 const
// mv_csr_decode                  O   152
// RDY_mv_csr_decode              O     1 const
// take_trap                      O    64
// RDY_take_trap                  O     1 const
// RDY_clint_msip                 O     1 const
// RDY_clint_mtip                 O     1 const
// RDY_clint_mtime                O     1 const
// RDY_incr_minstret              O     1 const
// RDY_ext_interrupt              O     1 const
// mv_csr_misa_c                  O     1 reg
// RDY_mv_csr_misa_c              O     1 const
// mv_interrupt                   O     1
// mv_curr_priv                   O     2 reg
// RDY_mv_curr_priv               O     1 const
// csr_mstatus                    O    64
// RDY_csr_mstatus                O     1 const
// mv_pmp_cfg                     O    32 reg
// RDY_mv_pmp_cfg                 O     1 const
// mv_pmp_addr                    O   120 reg
// RDY_mv_pmp_addr                O     1 const
// mv_trigger_data1               O    44 reg
// RDY_mv_trigger_data1           O     1 const
// mv_trigger_data2               O   128 reg
// RDY_mv_trigger_data2           O     1 const
// mv_trigger_enable              O     2
// RDY_mv_trigger_enable          O     1 const
// CLK                            I     1 clock
// RST_N                          I     1 reset
// system_instruction_csr_address  I    12
// system_instruction_op1         I    64
// system_instruction_funct3      I     3
// system_instruction_lpc         I     2
// take_trap_type_cause           I     6
// take_trap_pc                   I    64
// take_trap_badaddr              I    64
// clint_msip_intrpt              I     1 reg
// clint_mtip_intrpt              I     1 reg
// clint_mtime_c_mtime            I    64 reg
// ext_interrupt_ex_i             I     1 reg
// EN_clint_msip                  I     1
// EN_clint_mtip                  I     1
// EN_clint_mtime                 I     1
// EN_incr_minstret               I     1
// EN_ext_interrupt               I     1
// EN_system_instruction          I     1
// EN_take_trap                   I     1
//
// Combinational paths from inputs to outputs:
//   (system_instruction_csr_address,
//    system_instruction_funct3,
//    EN_system_instruction) -> system_instruction
//   (take_trap_type_cause, EN_take_trap) -> take_trap
//
//

`ifdef BSV_ASSIGNMENT_DELAY
`else
  `define BSV_ASSIGNMENT_DELAY
`endif

`ifdef BSV_POSITIVE_RESET
  `define BSV_RESET_VALUE 1'b1
  `define BSV_RESET_EDGE posedge
`else
  `define BSV_RESET_VALUE 1'b0
  `define BSV_RESET_EDGE negedge
`endif

module mkcsr(CLK,
	     RST_N,

	     system_instruction_csr_address,
	     system_instruction_op1,
	     system_instruction_funct3,
	     system_instruction_lpc,
	     EN_system_instruction,
	     system_instruction,
	     RDY_system_instruction,

	     mv_csr_decode,
	     RDY_mv_csr_decode,

	     take_trap_type_cause,
	     take_trap_pc,
	     take_trap_badaddr,
	     EN_take_trap,
	     take_trap,
	     RDY_take_trap,

	     clint_msip_intrpt,
	     EN_clint_msip,
	     RDY_clint_msip,

	     clint_mtip_intrpt,
	     EN_clint_mtip,
	     RDY_clint_mtip,

	     clint_mtime_c_mtime,
	     EN_clint_mtime,
	     RDY_clint_mtime,

	     EN_incr_minstret,
	     RDY_incr_minstret,

	     ext_interrupt_ex_i,
	     EN_ext_interrupt,
	     RDY_ext_interrupt,

	     mv_csr_misa_c,
	     RDY_mv_csr_misa_c,

	     mv_interrupt,

	     mv_curr_priv,
	     RDY_mv_curr_priv,

	     csr_mstatus,
	     RDY_csr_mstatus,

	     mv_pmp_cfg,
	     RDY_mv_pmp_cfg,

	     mv_pmp_addr,
	     RDY_mv_pmp_addr,

	     mv_trigger_data1,
	     RDY_mv_trigger_data1,

	     mv_trigger_data2,
	     RDY_mv_trigger_data2,

	     mv_trigger_enable,
	     RDY_mv_trigger_enable);
  input  CLK;
  input  RST_N;

  // actionvalue method system_instruction
  input  [11 : 0] system_instruction_csr_address;
  input  [63 : 0] system_instruction_op1;
  input  [2 : 0] system_instruction_funct3;
  input  [1 : 0] system_instruction_lpc;
  input  EN_system_instruction;
  output [128 : 0] system_instruction;
  output RDY_system_instruction;

  // value method mv_csr_decode
  output [151 : 0] mv_csr_decode;
  output RDY_mv_csr_decode;

  // actionvalue method take_trap
  input  [5 : 0] take_trap_type_cause;
  input  [63 : 0] take_trap_pc;
  input  [63 : 0] take_trap_badaddr;
  input  EN_take_trap;
  output [63 : 0] take_trap;
  output RDY_take_trap;

  // action method clint_msip
  input  clint_msip_intrpt;
  input  EN_clint_msip;
  output RDY_clint_msip;

  // action method clint_mtip
  input  clint_mtip_intrpt;
  input  EN_clint_mtip;
  output RDY_clint_mtip;

  // action method clint_mtime
  input  [63 : 0] clint_mtime_c_mtime;
  input  EN_clint_mtime;
  output RDY_clint_mtime;

  // action method incr_minstret
  input  EN_incr_minstret;
  output RDY_incr_minstret;

  // action method ext_interrupt
  input  ext_interrupt_ex_i;
  input  EN_ext_interrupt;
  output RDY_ext_interrupt;

  // value method mv_csr_misa_c
  output mv_csr_misa_c;
  output RDY_mv_csr_misa_c;

  // value method mv_interrupt
  output mv_interrupt;

  // value method mv_curr_priv
  output [1 : 0] mv_curr_priv;
  output RDY_mv_curr_priv;

  // value method csr_mstatus
  output [63 : 0] csr_mstatus;
  output RDY_csr_mstatus;

  // value method mv_pmp_cfg
  output [31 : 0] mv_pmp_cfg;
  output RDY_mv_pmp_cfg;

  // value method mv_pmp_addr
  output [119 : 0] mv_pmp_addr;
  output RDY_mv_pmp_addr;

  // value method mv_trigger_data1
  output [43 : 0] mv_trigger_data1;
  output RDY_mv_trigger_data1;

  // value method mv_trigger_data2
  output [127 : 0] mv_trigger_data2;
  output RDY_mv_trigger_data2;

  // value method mv_trigger_enable
  output [1 : 0] mv_trigger_enable;
  output RDY_mv_trigger_enable;

  // signals for module outputs
  wire [151 : 0] mv_csr_decode;
  wire [128 : 0] system_instruction;
  wire [127 : 0] mv_trigger_data2;
  wire [119 : 0] mv_pmp_addr;
  wire [63 : 0] csr_mstatus, take_trap;
  wire [43 : 0] mv_trigger_data1;
  wire [31 : 0] mv_pmp_cfg;
  wire [1 : 0] mv_curr_priv, mv_trigger_enable;
  wire RDY_clint_msip,
       RDY_clint_mtime,
       RDY_clint_mtip,
       RDY_csr_mstatus,
       RDY_ext_interrupt,
       RDY_incr_minstret,
       RDY_mv_csr_decode,
       RDY_mv_csr_misa_c,
       RDY_mv_curr_priv,
       RDY_mv_pmp_addr,
       RDY_mv_pmp_cfg,
       RDY_mv_trigger_data1,
       RDY_mv_trigger_data2,
       RDY_mv_trigger_enable,
       RDY_system_instruction,
       RDY_take_trap,
       mv_csr_misa_c,
       mv_interrupt;

  // ports of submodule csrfile
  reg [63 : 0] csrfile_write_csr_word;
  wire [151 : 0] csrfile_mv_csr_decode;
  wire [127 : 0] csrfile_mv_trigger_data2;
  wire [119 : 0] csrfile_mv_pmp_addr;
  wire [63 : 0] csrfile_clint_mtime_c_mtime,
		csrfile_csr_mstatus,
		csrfile_read_csr,
		csrfile_upd_on_ret,
		csrfile_upd_on_trap,
		csrfile_upd_on_trap_pc,
		csrfile_upd_on_trap_tval;
  wire [43 : 0] csrfile_mv_trigger_data1;
  wire [31 : 0] csrfile_mv_pmp_cfg;
  wire [11 : 0] csrfile_read_csr_addr, csrfile_write_csr_addr;
  wire [5 : 0] csrfile_upd_on_trap_cause;
  wire [1 : 0] csrfile_mv_curr_priv,
	       csrfile_mv_trigger_enable,
	       csrfile_upd_on_ret_prv,
	       csrfile_write_csr_lpc;
  wire csrfile_EN_clint_msip,
       csrfile_EN_clint_mtime,
       csrfile_EN_clint_mtip,
       csrfile_EN_ext_interrupt,
       csrfile_EN_incr_minstret,
       csrfile_EN_read_csr,
       csrfile_EN_upd_on_ret,
       csrfile_EN_upd_on_trap,
       csrfile_EN_write_csr,
       csrfile_clint_msip_intrpt,
       csrfile_clint_mtip_intrpt,
       csrfile_ext_interrupt_ex_i,
       csrfile_mv_csr_misa_c,
       csrfile_mv_interrupt;

  // rule scheduling signals
  wire CAN_FIRE_clint_msip,
       CAN_FIRE_clint_mtime,
       CAN_FIRE_clint_mtip,
       CAN_FIRE_ext_interrupt,
       CAN_FIRE_incr_minstret,
       CAN_FIRE_system_instruction,
       CAN_FIRE_take_trap,
       WILL_FIRE_clint_msip,
       WILL_FIRE_clint_mtime,
       WILL_FIRE_clint_mtip,
       WILL_FIRE_ext_interrupt,
       WILL_FIRE_incr_minstret,
       WILL_FIRE_system_instruction,
       WILL_FIRE_take_trap;

  // declarations used by system tasks
  // synopsys translate_off
  reg TASK_testplusargs___d1;
  reg TASK_testplusargs___d2;
  reg TASK_testplusargs___d3;
  reg [63 : 0] v__h427;
  reg TASK_testplusargs___d15;
  reg TASK_testplusargs___d16;
  reg TASK_testplusargs___d17;
  reg [63 : 0] v__h702;
  reg system_instruction_csr_address_BITS_11_TO_8_EQ_ETC___d20;
  // synopsys translate_on

  // remaining internal signals
  reg [63 : 0] y_avValue_snd_fst__h923;
  wire [63 : 0] writecsrdata__h863, writecsrdata__h864, x__h876;

  // actionvalue method system_instruction
  assign system_instruction =
	     { system_instruction_funct3 == 3'd0 &&
	       (system_instruction_csr_address[11:8] == 4'h0 ||
		system_instruction_csr_address[11:8] == 4'h3),
	       (system_instruction_funct3 == 3'd0) ?
		 { y_avValue_snd_fst__h923, 64'd0 } :
		 { 64'd0, csrfile_read_csr } } ;
  assign RDY_system_instruction = 1'd1 ;
  assign CAN_FIRE_system_instruction = 1'd1 ;
  assign WILL_FIRE_system_instruction = EN_system_instruction ;

  // value method mv_csr_decode
  assign mv_csr_decode = csrfile_mv_csr_decode ;
  assign RDY_mv_csr_decode = 1'd1 ;

  // actionvalue method take_trap
  assign take_trap = csrfile_upd_on_trap ;
  assign RDY_take_trap = 1'd1 ;
  assign CAN_FIRE_take_trap = 1'd1 ;
  assign WILL_FIRE_take_trap = EN_take_trap ;

  // action method clint_msip
  assign RDY_clint_msip = 1'd1 ;
  assign CAN_FIRE_clint_msip = 1'd1 ;
  assign WILL_FIRE_clint_msip = EN_clint_msip ;

  // action method clint_mtip
  assign RDY_clint_mtip = 1'd1 ;
  assign CAN_FIRE_clint_mtip = 1'd1 ;
  assign WILL_FIRE_clint_mtip = EN_clint_mtip ;

  // action method clint_mtime
  assign RDY_clint_mtime = 1'd1 ;
  assign CAN_FIRE_clint_mtime = 1'd1 ;
  assign WILL_FIRE_clint_mtime = EN_clint_mtime ;

  // action method incr_minstret
  assign RDY_incr_minstret = 1'd1 ;
  assign CAN_FIRE_incr_minstret = 1'd1 ;
  assign WILL_FIRE_incr_minstret = EN_incr_minstret ;

  // action method ext_interrupt
  assign RDY_ext_interrupt = 1'd1 ;
  assign CAN_FIRE_ext_interrupt = 1'd1 ;
  assign WILL_FIRE_ext_interrupt = EN_ext_interrupt ;

  // value method mv_csr_misa_c
  assign mv_csr_misa_c = csrfile_mv_csr_misa_c ;
  assign RDY_mv_csr_misa_c = 1'd1 ;

  // value method mv_interrupt
  assign mv_interrupt = csrfile_mv_interrupt ;

  // value method mv_curr_priv
  assign mv_curr_priv = csrfile_mv_curr_priv ;
  assign RDY_mv_curr_priv = 1'd1 ;

  // value method csr_mstatus
  assign csr_mstatus = csrfile_csr_mstatus ;
  assign RDY_csr_mstatus = 1'd1 ;

  // value method mv_pmp_cfg
  assign mv_pmp_cfg = csrfile_mv_pmp_cfg ;
  assign RDY_mv_pmp_cfg = 1'd1 ;

  // value method mv_pmp_addr
  assign mv_pmp_addr = csrfile_mv_pmp_addr ;
  assign RDY_mv_pmp_addr = 1'd1 ;

  // value method mv_trigger_data1
  assign mv_trigger_data1 = csrfile_mv_trigger_data1 ;
  assign RDY_mv_trigger_data1 = 1'd1 ;

  // value method mv_trigger_data2
  assign mv_trigger_data2 = csrfile_mv_trigger_data2 ;
  assign RDY_mv_trigger_data2 = 1'd1 ;

  // value method mv_trigger_enable
  assign mv_trigger_enable = csrfile_mv_trigger_enable ;
  assign RDY_mv_trigger_enable = 1'd1 ;

  // submodule csrfile
  mkcsrfile csrfile(.CLK(CLK),
		    .RST_N(RST_N),
		    .clint_msip_intrpt(csrfile_clint_msip_intrpt),
		    .clint_mtime_c_mtime(csrfile_clint_mtime_c_mtime),
		    .clint_mtip_intrpt(csrfile_clint_mtip_intrpt),
		    .ext_interrupt_ex_i(csrfile_ext_interrupt_ex_i),
		    .read_csr_addr(csrfile_read_csr_addr),
		    .upd_on_ret_prv(csrfile_upd_on_ret_prv),
		    .upd_on_trap_cause(csrfile_upd_on_trap_cause),
		    .upd_on_trap_pc(csrfile_upd_on_trap_pc),
		    .upd_on_trap_tval(csrfile_upd_on_trap_tval),
		    .write_csr_addr(csrfile_write_csr_addr),
		    .write_csr_lpc(csrfile_write_csr_lpc),
		    .write_csr_word(csrfile_write_csr_word),
		    .EN_read_csr(csrfile_EN_read_csr),
		    .EN_write_csr(csrfile_EN_write_csr),
		    .EN_upd_on_ret(csrfile_EN_upd_on_ret),
		    .EN_upd_on_trap(csrfile_EN_upd_on_trap),
		    .EN_incr_minstret(csrfile_EN_incr_minstret),
		    .EN_clint_msip(csrfile_EN_clint_msip),
		    .EN_clint_mtip(csrfile_EN_clint_mtip),
		    .EN_clint_mtime(csrfile_EN_clint_mtime),
		    .EN_ext_interrupt(csrfile_EN_ext_interrupt),
		    .read_csr(csrfile_read_csr),
		    .RDY_read_csr(),
		    .RDY_write_csr(),
		    .upd_on_ret(csrfile_upd_on_ret),
		    .RDY_upd_on_ret(),
		    .upd_on_trap(csrfile_upd_on_trap),
		    .RDY_upd_on_trap(),
		    .RDY_incr_minstret(),
		    .mv_csr_decode(csrfile_mv_csr_decode),
		    .RDY_mv_csr_decode(),
		    .mv_csr_misa_c(csrfile_mv_csr_misa_c),
		    .RDY_mv_csr_misa_c(),
		    .mv_curr_priv(csrfile_mv_curr_priv),
		    .RDY_mv_curr_priv(),
		    .csr_mstatus(csrfile_csr_mstatus),
		    .RDY_csr_mstatus(),
		    .RDY_clint_msip(),
		    .RDY_clint_mtip(),
		    .RDY_clint_mtime(),
		    .RDY_ext_interrupt(),
		    .mv_interrupt(csrfile_mv_interrupt),
		    .mv_pmp_cfg(csrfile_mv_pmp_cfg),
		    .RDY_mv_pmp_cfg(),
		    .mv_pmp_addr(csrfile_mv_pmp_addr),
		    .RDY_mv_pmp_addr(),
		    .mv_trigger_data1(csrfile_mv_trigger_data1),
		    .RDY_mv_trigger_data1(),
		    .mv_trigger_data2(csrfile_mv_trigger_data2),
		    .RDY_mv_trigger_data2(),
		    .mv_trigger_enable(csrfile_mv_trigger_enable),
		    .RDY_mv_trigger_enable());

  // submodule csrfile
  assign csrfile_clint_msip_intrpt = clint_msip_intrpt ;
  assign csrfile_clint_mtime_c_mtime = clint_mtime_c_mtime ;
  assign csrfile_clint_mtip_intrpt = clint_mtip_intrpt ;
  assign csrfile_ext_interrupt_ex_i = ext_interrupt_ex_i ;
  assign csrfile_read_csr_addr = system_instruction_csr_address ;
  assign csrfile_upd_on_ret_prv = system_instruction_csr_address[9:8] ;
  assign csrfile_upd_on_trap_cause = take_trap_type_cause ;
  assign csrfile_upd_on_trap_pc = take_trap_pc ;
  assign csrfile_upd_on_trap_tval = take_trap_badaddr ;
  assign csrfile_write_csr_addr = system_instruction_csr_address ;
  assign csrfile_write_csr_lpc = system_instruction_lpc ;
  always@(system_instruction_funct3 or
	  writecsrdata__h864 or system_instruction_op1 or writecsrdata__h863)
  begin
    case (system_instruction_funct3[1:0])
      2'd1: csrfile_write_csr_word = system_instruction_op1;
      2'd2: csrfile_write_csr_word = writecsrdata__h863;
      default: csrfile_write_csr_word = writecsrdata__h864;
    endcase
  end
  assign csrfile_EN_read_csr = EN_system_instruction ;
  assign csrfile_EN_write_csr =
	     EN_system_instruction && system_instruction_funct3 != 3'd0 ;
  assign csrfile_EN_upd_on_ret =
	     EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	     (system_instruction_csr_address[11:8] == 4'h0 ||
	      system_instruction_csr_address[11:8] == 4'h3) ;
  assign csrfile_EN_upd_on_trap = EN_take_trap ;
  assign csrfile_EN_incr_minstret = EN_incr_minstret ;
  assign csrfile_EN_clint_msip = EN_clint_msip ;
  assign csrfile_EN_clint_mtip = EN_clint_mtip ;
  assign csrfile_EN_clint_mtime = EN_clint_mtime ;
  assign csrfile_EN_ext_interrupt = EN_ext_interrupt ;

  // remaining internal signals
  assign writecsrdata__h863 = system_instruction_op1 | csrfile_read_csr ;
  assign writecsrdata__h864 = x__h876 & csrfile_read_csr ;
  assign x__h876 = ~system_instruction_op1 ;
  always@(system_instruction_csr_address or csrfile_upd_on_ret)
  begin
    case (system_instruction_csr_address[11:8])
      4'h0, 4'h3: y_avValue_snd_fst__h923 = csrfile_upd_on_ret;
      default: y_avValue_snd_fst__h923 = 64'd0;
    endcase
  end

  // handling of system tasks

  // synopsys translate_off
  always@(negedge CLK)
  begin
    #0;
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction)
	begin
	  TASK_testplusargs___d1 = $test$plusargs("fullverbose");
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction)
	begin
	  TASK_testplusargs___d2 = $test$plusargs("mcsr");
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction)
	begin
	  TASK_testplusargs___d3 = $test$plusargs("l2");
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction)
	begin
	  v__h427 = $time;
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction &&
	  (TASK_testplusargs___d1 ||
	   TASK_testplusargs___d2 && TASK_testplusargs___d3))
	$write("[%10d", v__h427, "] ");
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction &&
	  (TASK_testplusargs___d1 ||
	   TASK_testplusargs___d2 && TASK_testplusargs___d3))
	$write("CSR : Operation csr: %h op1: %h, funct3: %b csr_read: %h",
	       system_instruction_csr_address,
	       system_instruction_op1,
	       system_instruction_funct3,
	       csrfile_read_csr);
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction &&
	  (TASK_testplusargs___d1 ||
	   TASK_testplusargs___d2 && TASK_testplusargs___d3))
	$write("\n");
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  (system_instruction_csr_address[11:8] == 4'h0 ||
	   system_instruction_csr_address[11:8] == 4'h3))
	begin
	  TASK_testplusargs___d15 = $test$plusargs("fullverbose");
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  (system_instruction_csr_address[11:8] == 4'h0 ||
	   system_instruction_csr_address[11:8] == 4'h3))
	begin
	  TASK_testplusargs___d16 = $test$plusargs("mcsr");
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  (system_instruction_csr_address[11:8] == 4'h0 ||
	   system_instruction_csr_address[11:8] == 4'h3))
	begin
	  TASK_testplusargs___d17 = $test$plusargs("l1");
	  #0;
	end
    system_instruction_csr_address_BITS_11_TO_8_EQ_ETC___d20 =
	(system_instruction_csr_address[11:8] == 4'h0 ||
	 system_instruction_csr_address[11:8] == 4'h3) &&
	(TASK_testplusargs___d15 ||
	 TASK_testplusargs___d16 && TASK_testplusargs___d17);
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  (system_instruction_csr_address[11:8] == 4'h0 ||
	   system_instruction_csr_address[11:8] == 4'h3))
	begin
	  v__h702 = $time;
	  #0;
	end
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  system_instruction_csr_address_BITS_11_TO_8_EQ_ETC___d20)
	$write("[%10d", v__h702, "] ");
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  system_instruction_csr_address_BITS_11_TO_8_EQ_ETC___d20)
	$write("CSR : RET Function: %h", system_instruction_csr_address);
    if (RST_N != `BSV_RESET_VALUE)
      if (EN_system_instruction && system_instruction_funct3 == 3'd0 &&
	  system_instruction_csr_address_BITS_11_TO_8_EQ_ETC___d20)
	$write("\n");
  end
  // synopsys translate_on
endmodule  // mkcsr

